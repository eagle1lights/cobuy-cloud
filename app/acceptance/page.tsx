 'use client'; import { useEffect, useState } from 'react'; import { exportICS, exportCSV } from '@/lib/exports'; import { db } from '@/lib/db'; import { Task } from '@/lib/types'; export default function Acceptance(){const [checks,setChecks]=useState([{id:'local',label:'No POSTs in free mode',ok:undefined as boolean|undefined,details:''},{id:'exports',label:'Exports work offline',ok:undefined as boolean|undefined,details:''}]); const [tasks,setTasks]=useState<Task[]>([]); const [posts,setPosts]=useState(0); useEffect(()=>{(async()=>{const stored=await db.getAll('networkLogs'); setPosts(stored.filter(l=>(l.method||'').toUpperCase()==='POST').length); setTasks(await db.getAll('tasks'));})()},[]); function run(){const c=[...checks]; c[0].ok=posts===0; c[0].details=posts===0?'No POSTs logged':`${posts} POST(s)`; c[1].ok=tasks.length>0; setChecks(c);} return(<div className='card'><h2 className='text-lg font-semibold'>Acceptance</h2><div className='mt-3 flex gap-2'><button className='btn' onClick={run}>Run checks</button><button className='btn' onClick={()=>exportCSV(tasks)}>CSV</button><button className='btn' onClick={()=>exportICS(tasks)}>.ics</button><button className='btn' onClick={()=>window.print()}>PDF</button></div><table className='w-full text-sm mt-4'><thead><tr><th>Check</th><th>Status</th><th>Details</th></tr></thead><tbody>{checks.map(c=>(<tr key={c.id}><td>{c.label}</td><td>{c.ok==null?'—':c.ok?'✅':'❌'}</td><td>{c.details}</td></tr>))}</tbody></table></div>);} 